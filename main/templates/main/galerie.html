{% extends "main/base.html" %}

{% block content %}
<div class="container my-5">
    <!-- Galerie Photos -->
    <div class="band-title">ðŸ“· Galerie Photos</div>
    <div class="row row-cols-2 row-cols-sm-3 row-cols-md-4 g-3" id="photos-gallery">
        {% for media in medias %}
            {% if media.type == 'image' %}
            <div class="col">
                <div class="gallery-card">
                    <img src="{{ media.fichier.url }}" class="img-fluid rounded gallery-img"
                         alt="{{ media.titre }}"
                         data-bs-toggle="modal" data-bs-target="#mediaModal"
                         data-type="image" data-src="{{ media.fichier.url }}"
                         data-title="{{ media.titre }}">
                </div>
            </div>
            {% endif %}
        {% endfor %}
    </div>

    <!-- Galerie VidÃ©os -->
    <div class="band-title mt-5">ðŸŽ¥ Galerie VidÃ©os</div>
    <div class="row row-cols-2 row-cols-sm-3 row-cols-md-4 g-3" id="videos-gallery">
        {% for media in medias %}
            {% if media.type == 'video' %}
            <div class="col">
                <div class="gallery-card">
                    <video class="img-fluid rounded gallery-img" muted
                           data-bs-toggle="modal" data-bs-target="#mediaModal"
                           data-type="video" data-src="{{ media.fichier.url }}"
                           data-title="{{ media.titre }}">
                        <source src="{{ media.fichier.url }}" type="video/mp4">
                    </video>
                </div>
            </div>
            {% endif %}
        {% endfor %}
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="mediaModal" tabindex="-1" aria-labelledby="mediaModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-xl">
    <div class="modal-content bg-dark text-white rounded-3 shadow-lg">
      <div class="modal-header border-0">
        <h5 class="modal-title fw-bold" id="mediaModalLabel"></h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body text-center p-2">
        <img id="modalImage" class="img-fluid rounded d-none" alt="">
        <video id="modalVideo" class="img-fluid rounded d-none" controls>
          <source id="modalVideoSrc" src="" type="video/mp4">
        </video>
      </div>
    </div>
  </div>
</div>

<style>
/* Bande titre */
.band-title {
    background: linear-gradient(90deg, #2e58a7ff, #4674c2ff);
    color: #fff;
    text-align: center;
    font-size: 1.5rem;
    font-weight: bold;
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 20px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;

  background: radial-gradient(circle, #eaedeeff, #8f9296ff);

    /* Optionnel : occupe toute la hauteur de l'Ã©cran */
    min-height: 100vh;
}



/* Images & vidÃ©os */
.gallery-card {
    overflow: hidden;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
}
.gallery-card:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 16px rgba(0,0,0,0.25);
}
.gallery-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* Responsive modal */
@media (max-width: 576px) {
    .modal-dialog { max-width: 95%; margin: auto; }
    .modal-body img, .modal-body video { max-height: 60vh; }
}
</style>

<script>
var mediaModal = document.getElementById('mediaModal');
mediaModal.addEventListener('show.bs.modal', function (event) {
    var trigger = event.relatedTarget;
    var type = trigger.getAttribute('data-type');
    var src = trigger.getAttribute('data-src');
    var title = trigger.getAttribute('data-title');

    var modalTitle = mediaModal.querySelector('.modal-title');
    var modalImage = document.getElementById('modalImage');
    var modalVideo = document.getElementById('modalVideo');
    var modalVideoSrc = document.getElementById('modalVideoSrc');

    modalTitle.textContent = title;

    if(type === 'image'){
        modalImage.src = src;
        modalImage.classList.remove('d-none');
        modalVideo.classList.add('d-none');
        modalVideo.pause();
    } else if(type === 'video'){
        modalVideoSrc.src = src;
        modalVideo.load();
        modalVideo.classList.remove('d-none');
        modalImage.classList.add('d-none');
    }
});
</script>
{% endblock %}
